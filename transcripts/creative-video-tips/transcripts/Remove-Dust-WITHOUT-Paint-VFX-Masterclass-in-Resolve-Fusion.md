---
title: "Remove Dust WITHOUT Paint - VFX Masterclass in Resolve Fusion"
video_id: BV_a1VxquP8
channel: CreativeVideoTips
url: https://youtube.com/watch?v=BV_a1VxquP8
duration_seconds: 3507.0
date_processed: 2025-11-04
---

## Transcript
Tiny dust particles will find their way onto pretty much every screen, but the dust is usually mixed with great reflections that we want to keep in order to help sell a photorealistic composite. And in the commercial world, the client will almost always ask to clean up that screen in post. So you think we're going to use the paint tool, right? Nope. There's a better, faster, non-generative AI old school way. I'm talking about the unsung hero, the Fusion Rank Filter. You may have never heard of it before, but the beauty of the rank tool, which is a median filter, is that it's not averaging or blending pixels together. It's actually replacing them with a nearby surrounding pixel. That way you can keep sharp edges and still use the original reflections to add back on top of a screen replacement. Let's do some fusion comping together. We're going to planar track the phone, reduce the noise, clean the dust, composite a graphic, add controllable original reflections, and match the original grain. If you'd like to follow along with the 4k footage, you can download it by joining the cutting club at creativevideotips.com slash the cutting club. Thank you so much to those that have already joined. Go get your clip, and let's start compositing in DaVinci Resolve Fusion. Here's our phone footage we're working with today. Before I even go into fusion, one thing I'd like to point out is the importance of adding handles before you go to fusion in case you use motion blur. We like to use motion blur a lot in compositing. What I'm going to do, I'm going to unmark this clip by hitting option X, and I'm going to take the clip and make a duplicate straight above. Option will make a copy, and shift will keep it from moving left to right. If I hold option or alt on a PC with shift, it keeps it moving left and right and it makes a copy. On the clip above, I'm going to add the handles directly onto the clip that's on the timeline. This is going to hold all of the composition information. This will be our fusion comp. I'm not making that special separate fusion clip or reference comp. This is just working on one single clip at the source resolution with all of the metadata like timecode. Now, because I've done this, I'm going to just disable the clip underneath it. I'm selecting it, hitting D for disable so that I know I'm not working on it. Another thing I like to do, this is just a me thing to keep organized on the file section of this extra clip. I'm going to make it orange so I know it's a visual effect clip. And then on the name of it, instead of it being 709 at the end, I'll just call this comp V01. So it's really clear anytime I come back into this project or anyone else comes to it, what this is. This will hold the comp file. It's going to get that special like magic wand thing that's down here in the corner. Now to load this into fusion, super simple, the play heads parked over it, click the fusion button, and we can start comping. But I personally, I don't love this layout, the side by side layout that goes left to right. I like a top it down approach. So here's how that gets set up really quickly under workspaces. We're going to go to layout presets, fusion presets, mid flow vertical. Once you choose that, we've got a top down look, our nodes may have gone off to the side. There's always this thing appears that kind of shows you it's like a mini map if stuff goes off screen. So you can find your nodes again. And you do need to reset these to get a top down look at right now it's going left to right media ends the timeline, or the footage media out renders back to the timeline. So I like to move them so they're going top down, as well as a few other small things. One is we're looking at two viewers here, the one viewer is on top, the two viewer is down here. So that's one and two, I just like to use one of them. It uses less resources, as well as it just fills up the screen nicer. So if I use command mouse wheel move in or on a Wacom stylus that I like to put middle mouse to the bottom there, you can zoom into the pixels really, really fast that way, command f zooms back out. It just gives us a nice bigger workspace to look and see things. Now the other thing is we need to get other footage into here and set this up for a linear workflow. So to pull the other assets in here, like the screen insert elements, the screen replacement footage is I'm going to open up our media pool, you can do this right here from within fusion. I'm going to drag a logo for creative video tips, that's me. And then Milo labs who created a re green effect that we're going to get to at the end of this tutorial. So those are there for us to build the screen insert. And just a couple other things here. One is we need to convert this into linear gamma, which means no gamma, which means we're going to mimic how light works in the real world. And it's how compositing should always be done. Our color management settings on our DaVinci resolve project are basically no color management, it's set to DaVinci YRGB. And what that means is we're doing the color management ourselves, we're smart, we can look at our displays and see if things look correctly. But when you go to fusion, it's not taking care of conversion to linear like it would be if we were using color managed. Okay, this will do the linear conversion for you. This means we need to do it ourselves. No problem. I'm going to show you how to do that. So the media in nodes in resolve fusion have a source gamma space property to them over here in the inspector. Again, if these don't appear for you, just click the button, they'll show up pretty much always need the inspector. Now to remove the gamma curve, pretty simple, there's a button that says remove curve. And then space, we need to just tell it, we'll click the space button over here as well. We need to tell it what gamma space was this footage. Well, this was 709. And it is in fact, the 709 scene space. So as soon as that happens, you'll notice something in your viewer over here, things get dark. And that's normal, it's converted the footage to linear light, it's removed the gamma curve, which is a gamma curve would be a shape that kind of looks like this. And it's made a straight line out of it. But the challenge with working with linear is that the computer monitor over here is not linear, it has a gamma built in and mine has an sRGB gamma curve. So that's where infusion up here in the upper right section of the view, we have this little checkerboard grid option here. This is our viewer let section. So what we want to be choosing is the gamut view let. And as soon as you choose that, you should see some changes. Now there's an edit button up here as well. And I don't remember what the defaults are, but the idea is what you're going to need to do is set your output space to sRGB. If you have an sRGB monitor like me, and just click to add the gamma back in. So with that turned on, and it's turned on if it's white, we've just basically given ourselves a viewing space that is adding the gamma back in just to view it. Now if you're working with log footage, this is a side, I would use an ASUS workflow. Instead of doing it this way, you can use ASUS CG, because you'll be able to retain all the high dynamic range and extra color gamut footage that's available with it in its standardized. I have a tutorial on it. But for 709 footage, I just use the source gamma space built into the media in once. Now, the other footage I have over here, this created video tips thing, it's an sRGB graphic, and it also has one of these gamma curves to display it. And I need to convert this to linear. So each media in is going to need to be converted. So I'm going to select these different media ends, go to the source gamma space, choose space, click remove curve, gamma space, and these will be sRGB. And the same thing with this one over here. So this other logo, we're going to be combining space, remove curve, go down to sRGB. And you can see it's done the inverse, see this shape right here. It's done the inverse of the normal gamma curve for most footage for display, which is this direction. So that kind of cancels them out and that you get a straight line. Before you go back out to the edit page, we need to add the gamma curve back in at the end of the tree. So this is going to be our, our little color management sandwich. And the way I do that is first, I'm going to select the media in one over here. So that when I add a note, it adds it directly in the pipe without me needed to do any connections. I'm going to hit shift space. And the tool I'm going to use is called the gamut tool. And the gamut tool has, it's basically responsible for gamut. So if we load this into our viewer, and it's called the pick and flick method, I like to use some holding down on it, and I'm dragging and releasing up here in the viewer, you can always see in the viewer what you've got loaded. See this says gamut one, this is gamut one, this is telling us the state in the viewer. Now on this gamut viewer, what I need to do is add gamma back in. Okay, so over here in the inspector, I'm not worried about removing gamma, but I do want to add gamma. And I do want to say what is the output space I'm going back to just so you're fully in control, I'm going to say this is going to be going back to 709 scene. And so what this is just done is we've removed the gamma from media ends, and we've added the gamma right before media out. So that's going to be down there at the bottom. And the way you can always check to make sure your color management is very sound, go back to the edit page, make sure you've chosen the right settings is on the edit page, you have up here in the upper right, this bypass button, if you click this and you see no change, that means we've correctly round tripped the removal of the gamma and adding the gamma back in. Now real quick, before I end this little chapter on the setup is if you right click in your node flow area, you get this sort of contextual menu, I like to have force source tile pictures enabled. And what that does, you can see sources, which are media ends and that sort of thing, it gives you a little thumbnail. So a lot of people will go in and rename these tools, but this will give you a visual representation. So you don't have to worry about wasting time renaming things. Another couple other things that are nice that are on here, you see how the output is on the right side right now. Well, if you can have that change by just right clicking again and options and say, we're going to go to do do do do options, build flow vertically. And that'll change. So it's expecting sort of this top down vertical workflow, as well as one other thing over here that I think is nice is arrange tools to grid. With that, it just kind of gives you like a little bit of a snap. So that as I'm moving stuff around, it keeps things in a nice you can get these nice straight pipes and just stay organized as you go. A super quick performance tip that I'll give you is to cut the resolution for the bit depth in half to float 16 instead of float 32. The way you can ensure that you're always working in float 16 and resolve fusion is just after your media in shift space, choose CD for change depth node. Once that's chosen, change your depth instead of saying keep and we'll choose float 16 here instead of float 32. Make sure you don't do integer 16 but float 16 so we can go into negative values. And now anytime you do anything, you'll make sure that you're always working in 16 bit flow, which just cuts down resources. Noise reduction. So pretty much any visual effect you do on the high end, you've got to reduce the noise and this is going to do two things for us. One, we have these dust particles. This is going to just smooth this out a little bit before we even hit the rank filter, which is what's really going to clean it up. But it's also going to give us the difference between our cleaned up area and the original noise that when we add back a fake synthetic grain at the end, we have a difference between the cleaned up version and the original. So we know what that difference is so we can create fake noise. Now to actually see the noise, it's usually best if you look at the blue channel. Generally that has a lot of the noise in it. So if I hit B for blue, that takes us to the gray scale representation of the blue channel that's shown up here. So you can see these are the shortcuts red for red channel green for green channel etc etc. Now if you want to see your view again and you actually hit Z for zoom to fit like you would in the edit page, it takes you to the Z depth channel. I just want to point this out because this happens all the time. What you actually want to be you know choosing instead of Z for zoom to fit infusion is command or control F and I've got shortcuts down in the lower left here as I go. So if I go too fast and you miss something, check down there. But now we're still looking at Z depth. So if you want to look at the color channels again right up here, hit C for color and we're back at it. So let's get some noise reduction on this sucker. So I'm going to hit shift space, noise reduction, just start typing the word out. Different options here. One that I like to do use a lot is actually called Reduce Noise V5. This is the neat video one. It's a paid plugin. It's the best thing out there for sure. But we're just going to use what's built into DaVinci Resolve Studio, the paid version, which is this one called noise reduction hit add and it adds it right below here in our flow. If I want to see the result of the noise reduction, we need to load it into our two viewer. So I'm going to hold down, pick and flick. And as soon as they do that, you can see it says noise reduction up on top of there. But nothing is applied. There's no defaults on this. So what I'm going to do is I'm zooming into like an area without a whole lot of detail, you know, this this gray area of the color panel should do. And what I'll be looking for is first temporal noise reduction, which basically looks at noise over time. So frames before and frames after. And it sort of averages them out between to remove them. So motion estimation type is set to faster, better is just a better quality. And then what we'll do to actually turn it on is the threshold slider over here. So as I drag this to the right, we just start to see things start to go away. And you know, the little specs and pixels and it slows the machine down a little bit. The other thing I'll point out is I've reduced the render range. If you hold down command or control, I think on a PC, while you're dragging, you can reduce your preview render range, which you can see the green bar is the part that's been cached. Now this could maybe use a little bit of what's called spatial noise reduction as well, which spatial means it's just looking at the single frame and and mushing all the details together to sort of smooth things out. Whereas the temporal one looks at pixels across time. So if I look down here, see if there's any weird discoloration on the screen, there is just I mean, generally, you'll want to use a little bit of spatial noise reduction as well. So that'll just smooth things out a little bit. So I just have this up to like a value of four, that's maybe even too much. Actually, it's fine. We'll just go with that. So you can see that we've pretty much nailed and destroyed all of the noise that was in this clip, I think it was shot at like 12,800 on the FX three, and it's pretty much totally gone. hitting command F to zoom back out. And now I just want to reset my whole render range to the full frame again. So I'll right click down here and say auto render range, and it just expands so that all of the the scene is basically able to be seen and previewed. The crop tool is an easy way to reduce your domain of definition, which is all just a way of saying we're going to increase performance by only working on the sections of the frame over here that we want to be working on. So when we process things like the rank filter, we're going to reduce the amount of effect that's running through here, filling up our RAM. So it makes our cheaper computers go further. The way the crop tool works is we're going to be kind of making a crop sandwich of just the pixels and area that we need to work with. So after the noise reduction tool, I'm going to hit shift space and load crop CROP. And that is down here in line. Okay, so with crop loaded into the viewer can picking flicking to drag it on over there. Okay, so it's different than the crop if you're used to the edit page where you're just like removing sections of the side, this is actually going to be changing resolution. And that's why it works good to increase your performance. So if I take my X size, you can see over here, our resolution is going down, down, down. Now I've lost the phone and that's the part I need to be working on throughout the whole thing. So what I need to do is apply an X offset to get that centered again. See how that's working? So I'm using the X size to shrink it down. And then the X offset slider to sort of center this up. So I've already cut this from 3840 wide to what is that 1549 wide, which is just going to be that much less work the computer has to do, which means I'm going to have a nicer fun or time working infusion. I'm going to do the same to the y axis as well with the crop node. So the Y size instead of being that default 20, you know, 2160, whatever, I'm just shrinking this down. So this is getting smaller and smaller. And then I do the same thing with the Y offset. So I can keep the phone centered because the phone is the part that I am interested in and working on. And I just chose the wrong slider there on accident. So basically what I've done is I've just I've cut pixels out. So they're not going to be doing extra math and slowing down the machine. Now there is a whole sandwich thing to this thing. I need to get this back on top of the original picture. So what I'll do is I'll invert basically what I've done with the crop tool at the end of the node tree. So take the crop tool command C command V to paste that this puts this down lower in the flow, you can load the original crop tool over here. And it's not doing what we want by default, totally fine. What we need to do is we need to change our x and y size. This will go back to the original frame format, which is going to be 3840. I'm going to hit tab to go to the next one 2160. If I can type correctly. And so we've got our frame format correctly, except it's not in the right position. So the way you get the right position is we just have to do negative values to the x offset and y offset. So if I click up here instead of negative 1000, I'll do negative 1000. And then the next one I'll do negative 440. And this places it back in the exact same position on the frame. And to prove this and show you how this actually will be working once we get further down the stream, I'm going to move our gamut nodes over here. And we'll use the merge node. The merge node is basically you just put one image on top of the other. It's kind of like a layer from After Effects, shift space, m rg is our merge node. I'll take the original footage. Actually, let's take it from the change depth node, we'll just say the change depth is our say that's our original plate. And then we'll take our crop footage, which is this here with the blacked out edges. And by the way, if you don't see the blacked out edges, it's because I have a different default set over here, you should see checker underlay, you should see the transparency. And we'll just take the output of the crop node. This is a beauty of nodes, you can take multiple outputs from a single node. And we can stick this back over our merge. And so we've put the whole image back together. And the idea is this will end up being what we send back out to the edit page rank filter. So the rank filter is what's going to eat away these bright pixels. So if I hit shift space, R a and K, load the rank filter, pick inflict to load this into my monitor over here. And we see by default, it's a median filter. If you're used to that from Photoshop, a rank of point five says it's going to take the middle value of surrounding pixels. So let me show you a quick example of what I'm talking about when I say surrounding pixels. Literally, it's looking at like nine pixels over here. So if I had one pixel, two, three, four, five, six, seven, eight, nine, okay, and these are all in sort of a grid, you know, when you zoom in close, they're just pixels, it's going to be saying, Hey, this middle pixel here, I want to make changes to this middle pixel to an exact value of one of these that are around here of these nine. So what you would do is you would sort these in order, let's say one was point one, one was point three, one was point six, is going to list all of these in order, and it's going to pick the very middle value. But the power of the resolve rank filter is that you can choose instead of being the very middle value, which is point five, you can choose to be darker values to win or brighter values to win. So if you drag the rank to a lower number, darker pixels will eat brighter pixels. So in our case here, we want these darker pixels to eat up the brighter pixels. So what you do in the inspector for rank filter is drag your rank down towards the left, we'll drag it all the way down. And you can see even by without increasing the rank size, it's starting to eat those away. And it keeps the colors from the edges, which means it's going to hold sharp lines like a reflection really, really nicely. It's a way to kind of do an edge extend with just a simple filter. Now in our case here, we need more than a rank of one to actually eat away pretty much all of these. So we can just go crazy with it, turn it up to 10. And you can see now they're pretty much gone. Now, there's a few things about this that I would probably change right away. One is maybe don't go to zero on the rank, turn it up. So it's just a little bit higher. And I get through some of those, you know, blotches there. And then we do need to smooth this out just a little bit. Because we have some weird warbly, you know, some people call this the watercolor effect, we can get rid of that with a shift space blur afterwards. And just a subtle amount will sort of smooth things out a little bit. So if I turn the blur up to, I don't know, six or so, we've got a pretty good result. So this is the original footage. This is our blurred footage. And we have a nice reflection pass that keeps those original reflection lines that matches the plate exactly, which would be hard to do without using the original reflections. Now it's time to track this thing, we need to track it both so that we can put our screen replacement in it, and also so we can cut this blurred section out and stick that back on top. Now the tool to do this we're going to be using is the planar tracker. So shift space, PLAN, P-T-R-A is the shortcut. If you click here first, it'll just drop it wherever you want to put it, rather than automatically connect it to a pipe if you had something selected prior, little tip there. Now I want to be tracking just this cropped region for this example today. So what you can do is you can take another output from the crop node over here, that white grayish box, and stick this directly anywhere on top of the planar tracker, and it should go into the yellow input like that. The planar tracker needs a background yellow input to work. It's basically saying what pixels am I looking at. And the other thing to note about it, if I load it into the viewer, so I'm going to pick and flick this over here so we see it, we're looking at this before it was blurred. That's important because I'm actually going to steal and use these dust particles as little points to get an accurate track on the device. Now a couple of things about shooting screens and phones, I've talked about it a bunch before. Don't ever shoot a phone with a green screen because you're just going to roto fingers over anyways. And also probably don't include tracking markers because it's just more you have to clean up and paint afterwards if you want to use those original reflections. So even on this, this is the iPhone Pro 16 Max or whatever, which has like almost no bezels on the edges. Just shoot it with the phone off unless it needs to be a light source. And if that's the case, maybe shoot it with a solid gray background color or something like that to have it emitting more light. But now that we've got the planar tracker loaded over here, let me show you how we'll set this up. You select the clip and as soon as you do that and move the cursor over here, you'll see my cursor has like a little crosshair on it. It's ready to start drawing a polygon. And I will start on the frame that is largest and sharpest. So if I go to the ending frame, frame 76 here, it's smaller. So this is not a good one to draw and start as my reference frame. Because the way a planar tracker works is it's looking at all the pixels within the frame. And it looks as the changes over time based off of that reference frame. Okay, it's not looking at a specific single contrast point, it's looking at a large area over time. And so you want that area to be large and in charge. Okay, so I'm going to draw a shape here with my polygon, just by clicking, if you click and drag, it gets like a rounded bezel. Now the important thing is we want to avoid this reflection line because that's going to be moving over time and it's not reflective of the surface that we want to be tracking the pixels on. It's basically telling us based off of how the light's bouncing somewhere else in the room. So do not include reflections. If reflections go across your tracked area, then you'll get a bad track and it won't be usable. So sometimes I'm going to close this up right here. Sometimes you'll just actually just track bezels of phones because there should be so much reflection over the entire surface over the course of the shot. It really just depends. Every shot's unique. It's like a snowflake, right? So now that I have just this section selected, make sure the shape is closed, we come over here to the upper operation mode track. And if your largest and sharpest frame was not frame zero, which ours is all hit set, and that moved my key frame over here, you just hit set to set your reference frame to whatever the frame is you drew your polygon on, which again, largest and sharpest. Tracker, we have two methods to do this, point, hybrid point. I'm just going to choose point because it's the fastest and we have nice little points on here, as well as the motion type is going to be set to perspective, which is the default. It's the most comprehensive set of tracking data you can get from it. It's also the most likely to fail if it has a bad shape to look at. And the rest of this can be covered in another tracking tutorial. So I'm just going to hit track forward from here and you should see it should pick up on those little dust specs to help give it accurate tracking data over the course of the shot. My play head's moving down here as it's processing through. The main thing to note is we need detail on the planar tracker for it to work great. Otherwise, on a black, on a flat black screen, it's, it's not going to be too happy. So edges and bezels can usually work well. And Mocha Pro is able to sell basically any shot. So if this fails, that's when it's time to pony up, spend a few bucks on that. Now we don't know how accurate this was yet until we come over here to the inspector area where it says operation mode and change this to steady. And what steady does is it's basically locking off that shape that we did so that it's completely locked off and steady. And this is the best way to really sort of tell how solid is your track. So what you can do once you change that to operation mode steady is park your cursor over a pixel and then hit play. I'm just sitting the spacebar to see if that pixel or that point, that speck of dust is moving at all. And because I'm zoomed in here, you can't tell, but it actually is really locked off. Compared to the rest of the frame, you can see we're getting space around the outside, right, because it's centering off and locking off that center area. You might check an area up the top there, see if that pixel is moving or that dust speck. And it's not. So if this is moving, that means your track is no good. And you need to go retract, maybe change your shape a little bit, choose a different reference frame, until you can get it so that these pixels are not moving. Because if those aren't moving, all the other stuff is going to fail downstream. Alright, so now that we are fairly certain we have a good track, we can change this back over here, say operation mode to corner pin. So we'll use this as a corner pin built-in tool. There is another workflow where you can export a planar transform. That's not what I'm showing you today. So we're just going to use the operation corner pin mode. And what this does is as soon as you choose that, you get this crazy looking, this is what they think a corner pin should look like. It's this skewed image. And what you do is you just take these points, and this is what's going to be our mask and our screen replacement area. You just click and drag those out to the edges of the screen, so they match up visually. This can be done on the reference frame, it can be done in any frame because the idea is the tracking data is already there and it should follow. You can zoom in super, super close. Another thing to note is you can turn off your, what they call the pixel smoothing in the viewer, which is on by default smooth resize. See it's all mushy there. A lot of times I need to see those pixels to get pixel perfect. So then you can actually see those squares on there. So now that that is turned on, you can sort of get a preview of just that box as it's sort of following along. There's nothing in it yet because the operation or the merge mode on this is set to FG over BG, which means foreground over background. The FG is related to the green input on this node, which we have nothing going into it yet. Now before I show you the tool I use that you're going to want to download right away, I will show you in corner pin there is another option that says show grid. If you check that box, this is sort of another way you can use to check your, the quality of your track over time. I don't use it. I just wanted to make sure you knew it was there because it will come off after it plays back for a while. See after it just played back it, it something happens and it loses its stickiness. So I just leave show grid off. You have to turn enable on for corner pin to work. So don't turn that off, but turn off show grid. Now to actually see a better representation of something in here as a screen insert before we even get to throwing our graphics into there like this, what I like to do is use a tool from a free, amazing community of plugin developers called reactor. So fusion reactor, if you go to this website over here, it's a group of people stake underwater.com. So we want to go leave the link down below. It's a set of plugins that amazing smart people way smarter than me have created to help you make work in fusion a lot easier. It's kind of like a nukeopedia from nuke or matchbox from flame. But ml regrain is one we're going to use at the end of this tutorial that you can get from here. And the other one I want to show you right now is called the checkerboard effect. Now to load effects, if you're just first installed reactor, how do you get them to actually install to your system? You go to workspace scripts, reactor, open reactor, soon as you open reactor takes it a second, and then you will just search up here at the top, say we want checkerboard, you check the box, this one is from Muse effects, huge huge fans, so much good stuff. And you can see this is all the way from 2015. So it's like nine years old, and I still use it to this day. So the checkerboard effect, it's loaded on my machine, I hit that checkbox, I'm going to hit just space, type in checkerboard. And what it is, it's just a dummy black and white set of checkerboard, which is going to let me comp this into my planar tracker to check it and perfect the placement of my edges. Right. But the first thing to note is we look at this image here, it's 1920 by 1080. And the frame on the planar tracker that we set up for the corner pin, it's more of a vertical ratio, like a 1080 by 1920. So you can just change that in any of these settings. So on the checkerboard, I'll just flop the so instead of 1920 by 1080, I just changed 1080 by 19. If I could type the 1920, and that gives me like a vertical shape there, we take this, we drop this into the green input, that's where it's going to want to go, no worries. And now if you take a look, we have a temporary graphic for a screen replacement that we can easily refine the edges, and we'll take care of these rounded corners next. So to round the corners, you can do that a couple ways, you could round a source graphic, or you could apply a mask to it. I'm going to show you the more refined controllable mat control way. Alright, so with checkerboard selected, I'm going to add the mat control tool, shift space, MAT. Okay, this adds mat control. And the defaults of this is probably not set up this way. What you want to be using this for typically what I like to do is combine and use this set to combine alpha for the for the combined mode, which just means we're taking an alpha channel, which I'm going to get from this rectangle mask. So grab the rectangle mask, and we'll feed the rectangle mask into the green input. And see, by default, it wants to go into the blue input. So if it does that, that's basically a mask that happens downstream of all these other effects to take control and use all these other nice masking features that are built in like blurs, contract expand gamma, it needs to be working on this green foreground input. Now, when I did that, you'll see one thing happen, it's too small. And that's because the rectangle by default has height and width set to point five, we just drag those up to one gives us the full image again, and then we have the corner radius, which is going to let us cut those corners out. Okay, if you don't see this cutting out properly for you, under mat control, there's also a pulse multiply button down here, be cognizant. Sometimes you want to pulse multiply. Sometimes you don't. If you ever see black edges, it means you probably double pulse multiplied. So somewhere in your comp, you might need to go back and remove the multiplication, which just means you've zeroed out the alpha channel for it. Let's just say this is good for now. Obviously, it could be refined at any point by going to the planar tracker and say zoom in and then just take this, this edge here and move this, you know, to see fit. And you're not actually changing the tracking data when you move this, you're just moving the placement over time. So that should stick nicely. Now, one thing about anything that moves infusion is it has on the tool that's making it move, which is the planar tracker. Under the settings area, it has a motion blur switch. And this gets back to why we added handles in the first place is because motion blur is calculated based on C quality here is set to two. That means it's frames before and after. So this is like two frames before the frame and two frames after it's basically adding that blur, that realistic blur that we need to sell the shot. So make sure if you're using planar tracker, turn the motion blur on. However, for performance reasons, on the under the play bar area, you have the option to right click and say turn motion blur off. In fact, I'm going to turn high quality off as well, which is just going to give us better playback when we're caching and previewing things here. But it will render out from the edit page with motion blur, as long as you check that box over there. So we've got a cut out a planar tracked image. It's not the graphic we want to stick in there next. So I'm going to build that graphic really quickly using these two logos created video tips and Milo labs, which is the amazing Emilio that that created the regrain effect that I'm going to be showing you towards the end of the tutorial. If you look at the planar tracker, this has another advantage that we're going to get to with using our cleaned up reflection. And that's to cut it out because the planar tracker not only has the ability to do the operation that's called for ground corner pin foreground over background. It also has merge mode set to foreground only, which you can see where I'm going with this. And if I hit a for alpha, we have a perfect cut out that we can use for our cleanup reflection. All right, but for right now, I'm going to switch this back to foreground over background and hit C for color or come up here. So you can see C for color. And we'll build a little bit of a comp instead of using the checkerboard. We'll say our placement was good to go. So I'll get rid of checker board. And I'll comp these over a black solid. So the background node is our black solid node. Just drag that down here. And just like I did with the checkerboard, we need to change the resolution of this because it took the original resolution from the original footage, we need to change resolution here under image uncheck auto resolution and change this to 1080 by 1920. So that it matches the actual physical approximate dimensions of the phone. I know it's not exactly that. Now to get these two images onto the background, you can use this slick little merge technique, which is taking what you want on top start there. So I want this logo on top and attaching it to the basically I'm kissing the two outputs releasing in it creates a merge and it sticks that logo right on top, as well as I didn't want to do that again. So I want to take this logo and add this to here as well. I'll take the output of this, drag it to the gray output box and merge release and it creates another merge. And so green is on top, yellow is behind. So if I take a look at this, we see those two sort of stacked up. Now the position of it is not ideal. They're stacked exactly on top of each other at 0000. So I'm going to separate these a little bit. I'm going to move the this this one originally up a little bit higher. So what's happening with the merge to is there is basically a transform that's built into it. So you can choose to say center position here and it will act on the green foreground input. The idea with most these controls, including blend, it's always acting on that green foreground input. So if I raise that up a little bit, I could take the second one and maybe move that down a little bit. And this one probably could be scaled up. You can also use these on screen controls. If you just grab the corners to sort of scale things accordingly. And because I'm using two logos here, I might actually also want to use like a white line divider between those two. So I'll show you how I would do that. Selecting those to move that to the side, grab another background tool to get color, like maybe I'll choose like a white color, I can sample by dragging over here. And we've got a white color. And I want to mask off this white color, so that it is just a straight line. Easy way to do that would be just to stick this rectangle mask into it. Okay, so that is masking this off. And I can make this a thin line. It doesn't really matter so much that the resolution doesn't match at this point. I'm going to stick this on top of this comp right here, by taking the output again to get that gives us me an automatic merge. And now we can kind of see this visually as we as we make adjustments. So I might just scale this down here with the corners. And I might go in here to the mask and change the height so it's not as high again, you know, do this all to taste. It's just the idea is to kind of give a little bit separation between these two. I might shrink the meal lab logo down just a little bit. And let's just call these good for what they are. Now let's say this is what we want to feed into our planar tracker, I'm going to move this over to the side so you can get a better overview of how everything's connected screenshot it if you need to. And we'll take the output of this merge, which is our new screen comp, and go into the background of the mat control, the yellow background of it. You can see we've kind of just built ourselves a little, a nice little graphic there to look at. And if we take a look at the planar track result, we have a screen insert that we can start working on and add a reflection back on top. Channel Boolean's add. So we're going to take this full circle here, and we'll use this blur and stick this on top of the graphic. Now if you look at the output of the planar tracker itself right now, we actually have all these edge pixels. And the cool thing about the corner pin that's built in here, it's doing the merge force, but I don't want that I just want to get the output of this node to be just this screen that had those nice curves. So if you change the merge mode from foreground over background, at this point to foreground only, you'll see we get this nice moving mat, even if you hit A for alpha, that follows those curves perfectly. And we can still use this in multiple ways, one for the screen insert and one for the cutout of the reflection. I'm hitting C to see the color again, right now. And what we need to do is we're going to add after the blur tool, right, this is our whole blur section, we need to cut this out. Before we cut it out, I'm going to add these two together. The way we do that channel Boolean's shift space, BOL, channel Boolean's to make sure it's not the one with the, the three bowl, hit add. And then once we do that in the flow over here, this gives us mathematical operations we can use. And since we're working in linear light, we've removed the gamma remember, we can use operation set to add, and then alpha set to do nothing. And this thing is pretty much ready to go. The only thing is, is the way they're adding is not quite the way that we want these to work so that we can use the settings blend slider here to control the reflection amount. What you need to do for that is instead of this going into the yellow background input, this will be in the green foreground input of it. And the output of the planar tracker right now, this is actually going to be underneath it is the way I think of it. So Boolean's ad is kind of can go either way, but the blend slider works on that green foreground. So if you take the, the planar tracker output here, stick this into channel Boolean's and take a look at it. Now we've taken this footage and the green foreground we've added the cleaned up reflection on top. And if you play through, it's working nicely. Now this checkerboard thing that you sort of see looking kind of weird, that's, that indicates that it's an unpre multiplied. And so we're getting there. Hang on. So on this channel Boolean's, you can see if we want to reduce that reflection amount, maybe the client says we need a little bit less, you go to the settings. And if I turn this down, you can see I'm turning down the reflection on the screen, ignore the outside right now. But if you even wanted more reflection, this is all linear, you could double it up by hitting two on there and get even more reflection on there. I think I'll just leave that at a value of one. And we need to cut this out. Okay, so how are we going to cut it out? How did we cut out stuff before we used mat control. So after this is added using channel Boolean's, we're going to hit shift space, another mat control. And on this mat control here, make sure you're combined is set to combine alpha. Again, that's, that's not the default. You can set defaults in here by right clicking and saying settings, save default, and then those settings will be saved for next time, as well as pulse, multiply image. And if you take a look at the output of the alpha channel of the planar tracker, there's our alpha channel that we want to use to cut it out. Easy enough, right? So all you need to do is also feed the output of the planar tracker into the green foreground of the mat control, load that up over here. And now we've cut out the extra pixels off the edge of the the screen. And you can see we're really getting somewhere we're cooking with light. All right, so we got our cut out, but we need to re-grain this thing. So if we look back at our full comp that we've made so far, look at the merge of it. The original footage has grain and noise on the outside, but the replacement we did is too perfect. It's too smooth. Yeah, we got rid of the dust, but we also got rid of every part of digital signal processing that comes from having grain and noise. And the re-graining method I like to use is not just using the film grain tool that's built into here, but it's actually using this free tool or, you know, you can donate to. Milo Labs has this great tool called re-grain that you can get from the reactor plugin. And this is a new version that he just came out with a month ago. Right now it's on here. You can download it if you sign in or it'll be on reactor soon as well. But the way it works is just like this, really simple. We're going to add the re-grain tool down anywhere I click, shift space, re-grain, and it takes basically, it takes like three inputs. It'll take a original source footage, like with grain is the orange is yellowish input, the green is going to be a denoised input, purple is going to be your comp, you know, the cut out that we put on top that we want to be adding noise to. And then there's a mask input so that we can just restrict the re-graining, the synthetic grain to just the comp area. Right, so we're going to use all those and I'll show you how to connect it. So with re-grain selected and chosen, I'm going to take my original footage, which will be coming from here, dump it into, well, let's see if that'll work again, get it into the yellow input, and then the noise reduce footage. And by the way, if you don't know what inputs you're putting it into, if you hold down control on the output while you're dragging, it'll show you all the options available. So the noise reduce one's going into the denoised input of here. And once that is set up, one thing that you might notice is we need to set like a, it's going red right now, because it needs to set a time for an area to sample the difference between the de-grained part and the original one with grain. So with this selected, I'm going to come over here to set my source time to the frame that I want it to be. So frame zero, I think if you choose this button here, it'll choose that frame for me. And then the color space is linear. And the bit depth, we do want to keep it, this has to be working in float, but we're working in float 16 for this whole comp. And what we need to do is find a sample area for the grain. And when you choose the, when you select the node, you get this little box. It's kind of like there's that new, new noise reduction tool on the color page in 19. You kind of want to choose an area that doesn't have a whole lot of detail, so the, or texture to it. So this area right here is probably fine. And it's using that area to calculate the smooth out denoised versus the pixelated area to give you synthetic noise on the cleaned up section, right? So the other section, this pink input here is your comp output. The comp output is going to be the output of this crop node right here, this cleaned up section. So I'm going to pull this down here and just show you a couple organizational things. I hate lines crossing in my comp. So I'm going to hold option to create a little dot, you know, connector there, elbow joint, that's all that's happening. It's just to move things out and around. I'll do the same thing here with this line here, just so that I'm trying to keep a little bit of organization going. In fact, I'll show you one other organizational tool since we're at it. This whole section here is our, is our screen insert, right, that we built. It might be a little bit daunting when you first come in here. So you can use what's called an underlay. If you select all the nodes, shift space, underlay, it's like a backdrop. And then if you option select this, if you option select it and then hit, what is it, F2, you can rename this and say this will be insert or in replacement thing. You can even, if you want to make this real colorful, you can come over here and change that to a different color. It just makes it a little bit easier to see when you come back in. Now, getting back to the regrain, sorry about the detour, we want to feed the output of the crop node, which looks like this, right, into the comp input of regrain. I'm going to hit control so you can see you'll get the options of it going into that pink input, comp input. And as soon as you do that, without making any changes, you can see, if I really zoom in here, we're adding synthetic noise. Now, the only thing is, because we haven't masked, used the mask function on here yet, we're actually adding synthetic noise to the, to the original footage as well. So we want to just mask this off even further. That's what this mask input is for. So if I take this output of crop again, you'll notice that if I hit A, it has an alpha channel for us, it's built to end. So what I'll be doing is I'll also take the output of the crop, hold control and feed this into the mask input, or effect mask is what it's called. And the last thing you need to do to make this actually work, to cut it out is choose the multiply by mask section here in the settings. And then that just isolates. So we're just working on the insert and see we've added this nice grain without changing any other settings. There's a lot of settings you can do in regrain to find control it under a refined grain. However, I found the defaults in this new version work extremely well without having to fuss and change anything hardly at all. So now instead of loading the cleaned up cropped version into the merge over here, what I'll do is take the regrained version of our insert, stick that into merge. Okay. And now we have a grainy or realistically realistic looking comp by adding that grain back on top and only applying it to the screen replacement section. A couple quick touch ups and then I'll show you how to save this and render it out. First thing I want to point out is when we're working in linear light and we're adding light to pixels. If I zoom in here, we have values over one. So down in this section, this lower section underneath the viewer and I move my cursor, it's telling you values for the red, green and blue channels. And those have gone over one because I've added light pixels. And it sends those over one. So the simplest way that I found that I like to use to clamp them off so that they don't go over one is to use a brightness contrast node before it goes back over the top of the image. So what I'll do is the output of regrain, I'm going to insert a bc brightness contrast node and clip those values off to one shift space bc is the node. And another little shortcut to sneak this in here without rewiring this. If you just drag this while holding shift until the color changes there that green to blue, it puts it inside that that pipe there for you. And all we need to do to get this to clip those values off, you can see again, if I zoom in here, those are over one right now, the clip black clip white values, choose that. And now if I come over here, see how they're clamped off at one down here at the bottom, where they weren't before. So that takes care of like out of range, floating point values for you. And then you might want to come over here and say realistically, would that really always be pinned at one? Maybe not. So you might do a little bit of color correction to the elements themselves. So after the graphic itself, I would come over here at a bc brightness contrast node to this, just drag the the gain down slightly to it. Another thing to be aware of when you do anything with these controls, you want to always choose pre divide, post multiply, so you don't get any sort of weird, just checked that box. That's a whole other tutorial explanation. But I brought the values down here after the brightness and contrast to like point 73. Maybe that's too much. But the idea is you probably don't have anything that's like super pure white. And I might just take this node. Sorry, I pulled it out of the flow, make sure it has those lines. So it's connected, copy, choose this one paste, and that'll just bring down the other logo as well. As well as one other thing about CG elements, is there typically is a little bit of blur on them, right? So they're not going to typically be as sharp if they're photographed. So you could you could take care of that a few ways. One is a tilt shift blur, which would give you like a like a depth of field effect. And the other one is just the simple, regular old blur, maybe even set to a value of one or something, it just softens those edges out, and makes it look a little bit more realistic. So if I look at the merge now, we've brought those values down, see it's like a point 86 or whatever. And it looks a little bit more like it could actually live right there in the scene. So to render this, you've got quite a few different options. The main idea here is if we take a look, we've got our media out is going it's everything's piped in all the way to the edit page. So you could come over here to the edit page, and try to play it. And you'll just cry because the thing will never play back in real time at all, right? I mean, no matter how fast your computer is, you can over here right click on it and say render in place render tool high quality codec, call it good. The other thing you can do is use a saver that is inside of fusion and reconnect things in here as well. Just different ways of doing it. I haven't shown the savers a whole lot. And a lot of people aren't familiar with them. So I want to just show you how that works real quick. So after the gamut node, I'm going to add a saver node, which is going to write files out as an image sequence. So I'm going to hit SAV for saver. And the saver itself, again, we're doing this after the gamut node that added our gamma back into the image. That's why it looks wrong here. But if I turn this back off, it looks right again. Don't worry about that too much right now for the saver node. The main thing with saver node is in the inspector, we have some options on basically the format section, which the dwa 256 line compression of exr, you can only do exr's from resolve fusion. This is my preferred format to work for working in commercials or anything that is not feature film. I don't work in feature films. If you did, you probably need something that's uncompressed, but dwa 256 is a lot like a pro res 444 codec. So if you're used to that, this is pretty similar at the default compression of 45. Now to to set this up to actually save it and use it a final name, choose a location. So you'll say browse, you'll choose a place on your hard drive actually, because it's a tutorial, you always do this on tutorials, right? I would just make a folder that's called whatever this shot's going to be called. So this is going to be actually let me show you a shortcut to actually how I would do this. And maybe you show me a better way on the clip itself in the inspector, choose the name command C to copy that back over here in diffusion, browse, and here, delete, and then right click to say paste, we'll take that name dot dot, sorry, dot dot exr is basically just going to give us frames that match up with the frame number that's down here. And then we need to stick this in a folder. And so on tutorials, you always stick them in a desktop, right? So I'll say new folder in here. And I'll make sure this matches the same name, I'll say paste, say create, save, and then to render it out, you go up to fusion, render all savers. So I'll point out you can have multiple savers on here. If you don't want it to render one of your savers in the flow, you just turn it off with command P to pass through or hit this switch right here. But since I only have the one, hit fusion, render all savers, and it'll start cooking that render out. Just for reference, I'm working on an Apple M2 Max with about 64 gigs of RAM. And for this comp, it's rendering about 1.2 seconds per frame is what it's showing right now. Oh, and one other huge benefit to rendering two frames like with the exr is that if you just have one or two frames that you need to re render, you can change the render range, the yellow playhead area, and just render those new frames out without having to render an entire long sequence of shot that might take a long time. And it's done. It took about looks like a minute and a half. If you take a look at the desktop area, let's go over here. What was it today? You can see it makes this full sequence of images starting at frame zero. You cannot preview these dwa files, these Dreamworks exr's with quick look. However, you can load them right back in here to see them and use them. So select anywhere in the node flow over here, shift space, LD for loader. And the cool thing about the loader knows that it knows the exact location of what you just rendered. See this was at 819 is when that rendered. So all you can do is just just select the first and the sequence there. And this is now playing back the sequence of files that were written to my desktop, which will play back at a much faster speed. The reason it's not playing fast actually right now is because it's trying to play back to the to it's processing all this other crap that's that's going to media out. So to get a faster playback on the timeline, just connect, disconnect what's going to media out what's going back to the timeline, connect your, you know, the loader, which is the saved files from disk. And now if you come over here, you should get much, much better playback, especially once it plays back through once. So that that's playing back exr's in DaVinci Resolve 19 studio. Works pretty good. You can always use progress to just want to show you a different way. And then you would obviously trim this to see fit, as well as you can see our timecode matches up from the original plate to the, you know, to the original plate to the comp version. And you can see clearly we've made a huge improvement on getting rid of that dust with just a little bit of math from the rank filter. Take a look over here and we'll go over everything one last time in fusion. So you can see the whole node flow, the setup case, you missed anything along the way of how it's all working. Alright, so the recap is we have media in one, it's converted to linear space, we've changed the bit depth to float 16. We've done a noise reduction on it so that we've removed any of that noise, which has helped us calculate both the the the regrain effect and just cleaned up the screen in general. Then we have cropped the image to just be working on the section you're working on. I would do the same thing if I was doing a paint cleanup using the paint node, because it just reduces the resolution that you're working on without losing any pixels. We've done some rank filter, we've blurred out the rank filter to make it smooth. We use the planar tracker. The main thing about the planar tracker to note is that we use this in foreground only mode with our screen comp that we had built. And we did channel Boolean's add with the reflection being in the green foreground input. We cut it out with a matte control set to combine alpha, pulse multiply image. We uncropped the image so we set it back to the full 3840 by 70 resolution. And then we regrained it with the ml regrain tool. Now if you didn't want to do this way you could use the film grain tool that's built into Resolve. That's what part of this is using. It's just being smart about how much it's adding and doing it automatically. We clamp off the values over one with the brightness contrast tool, clip black, clip white. And we merge all of this screen insert back on top of the original footage. And we convert the gamut so that we're adding our gamma back in. And that's basically that's the deal. So I'll show you a quick before and after. You can do a split screen really easily in here with these buffers. So we're in the a buffer now if I go to the b buffer I load the original footage in here. And the b buffer doesn't have the the viewer let's turn on so I'll change the gamut view. Make sure this is set the same way adding the sRGB gamma. And then you have over here buffer split wipe. You can see the before and after. And all those specs are gone but we've retained the reflection which really sells the effect. Hey welcome if you're new to the channel I'm Chadwick and because there's so much more to learn I'll see you in the next video.
